var app=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=14)}([function(e,t){var n=function(){this._locations=[]};n.prototype={_locations:null,_escapeNestedQuotes:function(e){for(var t,n="",r=!1,i=0,o=0,s=e.length;o<s;++o)t=e[o],"<"===t&&!1===r&&0===i&&(r=!0),">"===t&&!0===r&&0===i&&(r=!1),'"'===t&&r&&++i>1&&(0==i%2&&(0!=i%2||" "!==e[o+1]&&">"!==e[o+1])||(i-=2),i>0&&(t="&quot;")),n+=t;return n},_escapeCodeTags:function(e){var t=/<code[ a-z"'-_=|]*>(?:(?!<code).|[\r\n])*<\/code>/gi,n=e.match(t);if(n)for(var r,i,o=/<code[ a-z"'-_=|]*>((?:(?!<code).|[\r\n])*)<\/code>/i,s=0,a=n.length;s<a;++s)r=n[s].match(o)[1],i=n[s].replace(r,r.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")),e=e.replace(n[s],i);return e},_escapeSelector:function(e){return e.replace(/#([0-9])/g,"#\\3$1 ").replace(/:+((?!not)[^: ]*)/g,'[type="$1"]')},_removeComments:function(e){var t=/<!--[^>]*-->/gi;return e=e.replace(t,"")},createElement:function(e){e=e.trim(),e=this._removeComments(e),e=this._escapeCodeTags(e),e=this._escapeNestedQuotes(e);var t=null,n=document.createElement("temp");if(n.innerHTML=e,1===n.childNodes.length)t=n.firstChild.cloneNode(!0);else if(n.childNodes.length>1){t=document.createDocumentFragment();for(var r=0,i=n.childNodes.length;r<i;++r)t.appendChild(n.childNodes[r].cloneNode(!0))}return n=null,t},insertElement:function(e,t,n){if(!e.getAttribute("outside-dom")){var r=document.createDocumentFragment();r.appendChild(e),this.insertInPosition(r,t,n)}},insertElements:function(e,t,n){for(var r=document.createDocumentFragment(),i=0,o=e.length;i<o;++i)e[i].getAttribute("outside-dom")||r.appendChild(e[i]);this.insertInPosition(r,t,n)},insertInPosition:function(e,t,n){n>=0&&t.childNodes[n]&&t.childNodes[n].parentNode?t.insertBefore(e,t.childNodes[n]):t.appendChild(e)},putBackElement:function(e){if(null===e.parentNode&&e.getAttribute("outside-dom"))for(var t,n=0,r=this._locations.length;n<r;++n)if(this._locations[n].element===e){t=this._locations[n],t.next&&t.next.parentNode===t.parent?t.parent.insertBefore(e,t.next):t.prev&&t.prev.parentNode===t.parent?t.prev.nextSibling?t.parent.insertBefore(e,t.prev.nextSibling):t.parent.appendChild(t.element):0===t.parent.childNodes.length||t.parent.childNodes.length<t.position?t.parent.appendChild(t.element):t.parent.insertBefore(e,t.parent.childNodes[t.position]),e.removeAttribute("outside-dom"),this._locations.splice(n,1);break}},removeElement:function(e){e&&null!==e.parentNode&&e.parentNode.removeChild(e)},putAsideElement:function(e){e&&null!==e.parentNode&&(this._locations.push({element:e,parent:e.parentNode,position:this.getPosition(e),prev:e.previousSibling,next:e.nextSibling}),this.removeElement(e),e.setAttribute("outside-dom",!0))},getPosition:function(e){if(!e||null===e.parentNode)return null;for(var t=0,n=e;null!==(n=n.previousSibling);)++t;return t},find:function(e,t){var n=[];if(e.match(/^#+[a-z0-9_-]+$/i))n.push(document.getElementById(e.substr(1)));else{t=t||document.documentElement;try{n=[].slice.call(t.querySelectorAll(e))}catch(r){n=[].slice.call(t.querySelectorAll(this._escapeSelector(e)))}}return n.filter(function(e){return null!==e})},first:function(e,t){var n=this.find(e,t);return n.length>0?n[0]:null},isMatching:function(e,t){var n=!1,r=HTMLElement.prototype.matches||HTMLElement.prototype.matchesSelector||HTMLElement.prototype.msMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.oMatchesSelector||null;if(r)try{n=r.call(t,e)}catch(i){n=r.call(t,this._escapeSelector(e))}return n},formToObject:function(e){if(!e||"FORM"!==e.nodeName)return{};var t,n,r={};for(t=e.elements.length-1;t>=0;--t)if(""!==e.elements[t].name)switch(e.elements[t].nodeName){case"INPUT":switch(e.elements[t].type){case"text":case"hidden":case"password":case"button":case"reset":case"submit":case"file":r[e.elements[t].name]=e.elements[t].value;break;case"checkbox":case"radio":e.elements[t].checked&&(r[e.elements[t].name]=e.elements[t].value)}break;case"TEXTAREA":r[e.elements[t].name]=e.elements[t].value;break;case"SELECT":switch(e.elements[t].type){case"select-one":r[e.elements[t].name]=e.elements[t].value;break;case"select-multiple":for(n=e.elements[t].options.length-1;n>=0;--n)r[e.elements[t].name]=[],e.elements[t].options[n].selected&&r[e.elements[t].name].push(e.elements[t].options[n].value)}break;case"BUTTON":switch(e.elements[t].type){case"reset":case"submit":case"button":r[e.elements[t].name]=e.elements[t].value}}return r}},e.exports=new n},function(e,t){var n=function(){return this._routes={},this};n.prototype={_routes:null,register:function(e){var t=e.getName();if(this._routes[t])throw new Error('A route with name "'+t+'" is already registered.');return this._routes[t]=e,this},findRoute:function(e,t){for(var n in this._routes)if(this._routes[n].match(e,t))return this._routes[n];return null},generateUrl:function(e,t,n){if(!this._routes[e])throw new Error('Try to generate an url for a route named "'+e+'" that is not registered.');return this._routes[e].generateUrlWithParams(t,n)}},e.exports=new n},function(e,t){var n={setPropertyValue:function(e,t,n){for(var r=t.split("."),i=0,o=r.length;i<o;++i)i+1<o?e=void 0!==e[r[i]]?e[r[i]]:e[r[i]]={}:e[r[i]]=n;return e},getPropertyValue:function(e,t){for(var n=t.split("."),r=0,i=n.length;r<i&&void 0!==(e=e[n[r]]);++r);return e},removeProperty:function(e,t){for(var n=t.split("."),r=0,i=n.length;r<i;++r)if(r<i-1){if(void 0===(e=e[n[r]]))break}else delete e[n[r]]},duplicateProperties:function(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},getTypeOf:function(e){return Object.prototype.toString.call(e).replace("[object ","").replace("]","").toLowerCase()},redefineProperty:function(e,t,n,r){"function"==typeof Object.prototype.defineProperty?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:n,set:r}):Object.prototype.__defineGetter__&&Object.prototype.__defineSetter__&&(Object.prototype.__defineGetter__.call(e,t,n),Object.prototype.__defineSetter__.call(e,t,r))}};e.exports=n},function(e,t,n){function r(e,t,n){var r,s;for(r in e)s=l.getTypeOf(e[r]),e.hasOwnProperty(r)&&"function"!==s&&function(t){o(e,r,function(e,r,i,o){n.trigger(e,t,i,o)}),i(e,r,t,e[r],s,n)}(t?t+"."+r:r)}function i(e,t,n,a,u,c){e[t]instanceof s||(u=u||l.getTypeOf(a),"object"===u?(r(e[t],n,c),c.on("change",n,function(){r(e[t],n,c);for(var i in c._callbacks)n!==i&&-1!==i.indexOf(n)&&c.trigger("change",i,l.getPropertyValue(e[t],i))})):"array"===u&&(e[t]=new s(a,function(e,t){c.trigger(e,n,t)}),r(e[t],n,c),c.on("change",n,function(i){e[t]instanceof s||(i=i||e[t],delete e[t],e[t]=new s(i,function(e,t){c.trigger(e,n,t)}),o(e,t,function(e,t,r,i){c.trigger(e,n,r,i)}),r(e[t],n,c))}).on("add",n,function(r){var s;if(r instanceof Array)for(var a=0,l=r.length;a<l;++a)s=e[t].indexOf(r[a]),function(n){o(e[t],s,function(e,t,r,i){c.trigger(e,n,r,i)}),i(e[t],s,n,e[t][s],null,c)}(n?n+"."+s:s);else s=e[t].indexOf(r),function(n){o(e[t],s,function(e,t,r,i){c.trigger(e,n,r,i)}),i(e[t],s,n,e[t][s],null,c)}(n?n+"."+s:s)})))}function o(e,t,n){var r=e[t],i=r;l.redefineProperty(e,t,function(){return r},function(e){i=r,r=e,i!==e&&n("change",t,e,i)})}var s=n(10),a=n(6),l=n(2),u=function(e){var t=new a;return l.duplicateProperties(e,this),r(this,null,t),this.on=function(e,n,r){t.on(e,n,r)},this.trigger=function(e,t,n){if("change"===e){n!==l.getPropertyValue(this,t)&&l.setPropertyValue(this,t,n)}},this};e.exports=u},function(e,t,n){var r=function(e,t){var r=n(11),i=document.createElement("a");return i.href=e,r.delegate({preventDefault:function(){},target:i},t)};e.exports=r},function(e,t,n){var r=n(6),i=new r,o={on:function(e,t){i.on(e,"app",t)},off:function(e,t){i.off(e,"app",t)},trigger:function(e){var t=Array.prototype.slice.call(arguments,1);return t.unshift(e,"app"),!1!==i.trigger.apply(i,t)}};e.exports=o},function(e,t){var n=function(){return this._callbacks={},this};n.prototype={_callbacks:null,on:function(e,t,n){return this._callbacks[t]=this._callbacks[t]||{},this._callbacks[t][e]=this._callbacks[t][e]||[],-1===this._callbacks[t][e].indexOf(n)&&this._callbacks[t][e].push(n),this},off:function(e,t,n){if(this._callbacks[t]&&this._callbacks[t][e]){var r=this._callbacks[t][e].indexOf(n);return-1!==r&&this._callbacks[t][e].splice(r,1),this}},trigger:function(e,t){if(this._callbacks[t]&&this._callbacks[t][e]){for(var n=0,r=this._callbacks[t][e].length;n<r;++n)if(!1===this._callbacks[t][e][n].apply(this,Array.prototype.slice.call(arguments,2)))return!1;return this}},clear:function(){return this._callbacks={},this}},e.exports=n},function(e,t,n){var r=n(8),i=new r;e.exports=i},function(e,t,n){var r=n(0),i=function(){return this._listeners=[],this};i.prototype={_listeners:null,_extractEvents:function(e){return e.split(",").map(function(e){return e.trim()})},_findTarget:function(e,t,n){if(this._listeners[e])for(var r=0,i=this._listeners[e].length;r<i;++r)if(t===this._listeners[e][r].selector&&n===this._listeners[e][r].callback)return this._listeners[e][r];return null},_findTargets:function(e,t){for(var n=[],i=0,o=this._listeners[e].length;i<o;++i)r.isMatching(this._listeners[e][i].selector,t)&&n.push(this._listeners[e][i]);return n},_addTarget:function(e,t,n){this._listeners[e]||(this._listeners[e]=[]),this._findTarget(e,t,n)||this._listeners[e].push({selector:t,callback:n})},_removeTarget:function(e,t,n){var r=this._findTarget(e,t,n);r&&this._listeners[e].splice(this._listeners[e].indexOf(r),1)},_addListener:function(e,t,n){if(t.addEventListener)t.addEventListener(e,n,!1);else{if(!t.attachEvent)throw new Error("Given element can not have a listener.");t.attachEvent("on"+e,function(){return n.call(window.event.srcElement,window.event)})}},_removeListener:function(e,t,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent&&t.detachEvent("on"+e,function(){return n.call(window.event.srcElement,window.event)})},_createEvent:function(e,t){var n;return document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(e,!0,!0)):(n=document.createEventObject(),n.eventType=e),n.eventName=e,n.target=t,n},_dispatchEvent:function(e,t){"string"==typeof e&&(e=this._createEvent(e,t)),document.createEvent?t.dispatchEvent(e):t.fireEvent("on"+e.eventType,e)},_createDelegatedEvent:function(e){if(!this._listeners[e.type])return e;for(var t,n=e.target||e.srcElement,i=0,o=this._listeners[e.type].length;i<o;++i){for(t=n;t&&!1===r.isMatching(this._listeners[e.type][i].selector,t);)t=t.parentNode&&document!==t.parentNode?t.parentNode:null;if(t)break}if(!t)return e;var s={};for(var a in e)s[a]=e[a];return s.returnValue=null,s.preventDefault=function(){e.preventDefault?e.preventDefault():e.returnValue=!1,this.returnValue=!1},s.target=s.srcElement=t,s},_delegate:function(e){if(this._listeners[e.type])for(var t=this._createDelegatedEvent(e),n=this._findTargets(t.type,t.target),r=0,i=n.length;r<i;++r)if(n[r].callback.call(t.target,t),!1===t.returnValue)return},on:function(e,t,n){e=this._extractEvents(e);for(var r="string"==typeof t,i=0,o=e.length;i<o;++i)if(r){if(!this._listeners[e[i]]){var s=this;this._addListener(e[i],document,function(e){s._delegate(e)})}this._addTarget(e[i],t,n)}else this._addListener(e[i],t,n);return this},off:function(e,t,n){e=this._extractEvents(e);for(var r="string"==typeof t,i=0,o=e.length;i<o;++i)r?this._removeTarget(e[i],t,n):this._removeListener(e[i],t,n);return this},trigger:function(e,t){e=this._extractEvents(e);for(var n="string"==typeof t,i=n?r.find(t):null,o=0,s=e.length;o<s;++o)if(n)for(var a=0,l=i.length;a<l;++a)this._dispatchEvent(e[o],i[a]);else this._dispatchEvent(e[o],t);return this},clear:function(){for(var e in this._listeners)this._listeners[e]=[];return this}},e.exports=i},function(e,t){var n=function(){return this._cache={},this};n.prototype={_cache:null,_buildConfig:function(e,t,n,r){return r=r||{},r.method=t,r.url=e,r.data=n,r},_initConfig:function(e){if(!e.url)throw new Error("No url provided.");if(e.method=e.method||"GET",-1===["GET","POST","PUT","DELETE"].indexOf(e.method))throw new Error("Only methods GET, PUT, POST, DELETE are allowed.");if("GET"===e.method&&e.data){var t=[];for(var n in e.data)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e.data[n]));t=t.join("&"),e.url+=(-1===e.url.indexOf("?")?"?":"&")+t,e.data=null}else if("POST"===e.method||"PUT"===e.method)if("JSON"===e.dataType)e.data=JSON.stringify(e.data);else{var r=new FormData;for(var i in e.data)r.append(i,e.data[i]);e.data=r}return e.format=e.format||null,e.headers=e.headers||{},e.async=!1!==e.async,e.cors=!0===e.cors,e.cache=!0===e.cache,e.success=e.success||function(){},e.error=e.error||function(){},e.always=e.always||function(){},e.progress=e.progress||function(){},e.timeout=e.timeout||function(){},e},_buildPublicApi:function(e,t){return{success:function(t){return e.success=t,this},error:function(t){return e.error=t,this},always:function(t){return e.always=t,this},abort:function(){return t.abort(),this}}},_handleError:function(e,t,n){e.error&&(e.error.call(e,n,t.status),e.error=null,e.always.call(e))},_handleResponse:function(e,t){var n=this._parseResponse(e,t.responseText);return t.status>=200&&t.status<400?(e.cache&&"GET"===e.method&&(this._cache[e.url]=t.responseText),e.success.call(e,n,t.status),e.always.call(e)):this._handleError(e,t,n),n},_parseResponse:function(e,t){return"JSON"===e.format?JSON.parse(t):t},call:function(e){e=this._initConfig(e);var t,n=this;if("GET"===e.method&&this._cache[e.url]&&!1!==e.cache)return t={responseText:this._cache[e.url],status:200},e.async?(setTimeout(function(){n._handleResponse(e,t)},1),this._buildPublicApi(e,t)):this._handleResponse(e,t);if(t=new(XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0"),e.cors)if("withCredentials"in t);else{if("undefined"!=typeof XDomainRequest)throw new Error("Your browser does not support CORS request.");t=new XDomainRequest}if(t.open(e.method,e.url,e.async),t.setRequestHeader){t.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"!==e.method&&"PUT"!==e.method||"JSON"!==e.dataType||t.setRequestHeader("Content-Type","application/json");for(var r in e.headers)t.setRequestHeader(r,e.headers[r])}return e.async?(t.onprogress&&e.onprogress&&(t.onprogress=function(){if(t.lengthComputable){var n=t.loaded/t.total;e.progress(n)}}),t.ontimeout&&e.ontimeout&&(t.ontimeout=e.timeout),t.onreadystatechange=function(){t.readyState>3&&n._handleResponse(e,t)},t.onerror=function(){n._handleResponse(e,t)},setTimeout(function(){t.send(e.data)},0),this._buildPublicApi(e,t)):(t.send(e.data),this._handleResponse(e,t))},get:function(e,t,n){return this.call(this._buildConfig(e,"GET",t,n))},post:function(e,t,n){return this.call(this._buildConfig(e,"POST",t,n))},put:function(e,t,n){return this.call(this._buildConfig(e,"PUT",t,n))},delete:function(e,t,n){return this.call(this._buildConfig(e,"DELETE",t,n))}},e.exports=new n},function(e,t){var n=function(e,t){for(var n=0,r=e.length;n<r;++n)this[n]=e[n];return this.length=e.length,this._handler=t,this},r=Array.prototype,i={pop:"remove",push:"add",reverse:"change",shift:"remove",sort:"change",splice:"remove",unshift:"add"};for(var o in i)!function(e){n.prototype[e]=function(){var t,n=i[e],o=r[e].apply(this,arguments);return"remove"===n||"change"===n?t=o:"add"===n&&(t=arguments[1]?r.slice.call(arguments):arguments[0]),this._handler(n,t),o}}(o);for(var s=["concat","every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString","toString"],a=0,l=s.length;a<l;++a)n.prototype[s[a]]=r[s[a]];e.exports=n},function(e,t,n){var r=n(17),i=n(23),o=n(12),s=n(1),a=n(4),l=n(5),u=new function(){var e={};this.add=function(t,n){if(void 0!==e[t])throw new Error('A page with the name "'+t+'" is already defined.');return n.name=t,e[t]=new r(n),this},this.get=function(t){if(void 0===e[t])throw new Error('No page with the name "'+t+'" could be found.');return e[t]},this.delegate=function(t,n){if(t){var r=t.target;if(!r.getAttribute("data-no-follow")){var o=r.tagName.toUpperCase(),a="FORM"===o?r.action:r.href;if(/#$/.test(a))return void t.preventDefault();var u="FORM"===o?r.method.toUpperCase():"GET",c=s.findRoute(a,u);if(!c)return void l.trigger("route.not_found",new i({event:t}));var h=new i({event:t,route:c});if(!1!==l.trigger("route.found",h)){var f=e[c.getScheme()];if(f&&!1!==l.trigger("page.pre_run",h))return t.preventDefault(),n=void 0===n,f.run(h,n),l.trigger("page.post_run",h),!1}}}},o.on("click","[href]",this.delegate).on("submit","form",this.delegate).on("load",window,function(){a(window.location.href,!1)})};e.exports=u},function(e,t,n){var r=n(8),i=new r;e.exports=i},function(e,t,n){var r=n(20),i=new function(){var e={},t=null;this.add=function(t,n){if(void 0!==e[t])throw new Error('A view with the name "'+t+'" is already defined.');return e[t]=new r(n),e[t]},this.get=function(t){if(void 0===e[t])throw new Error('No view with the name "'+t+'" could be found.');return e[t]},this.render=function(n,r){if(void 0===e[n])throw new Error('No view with the name "'+n+'" could be found.');!0!==r&&(t&&t!==e[n]&&t.revoke(),t=e[n]),e[n].render()},this.revoke=function(n){if(void 0===e[n])throw new Error('No view with the name "'+n+'" could be found.');t===e[n]&&(t=void 0),e[n].revoke()}};e.exports=i},function(e,t,n){e.exports={channel:n(5),events:n(7),http:n(9),memory:n(15),models:n(16),pages:n(11),views:n(13),redirect:n(4),router:n(1)}},function(e,t,n){var r=n(2),i=function(){this._storage=window.localStorage||window.globalStorage||{},this._root=this._storage[this._namespace]?JSON.parse(this._storage[this._namespace]):{}};i.prototype={_storage:{},_root:{},_namespace:"nucleon_app",_save:function(){var e=this;setTimeout(function(){e._storage[e._namespace]=JSON.stringify(e._root)},0)},set:function(e,t){return r.setPropertyValue(this._root,e,t),this._save(),this},get:function(e){return r.getPropertyValue(this._root,e)},all:function(){return this._root},remove:function(e){return r.removeProperty(this._root,e),this._save(),this},clear:function(){return this._root={},this._save(),this}},e.exports=new i},function(e,t,n){var r=n(3),i=new function(){var e={};this.add=function(t,n){if(void 0!==e[t])throw new Error('A model with the name "'+t+'" is already defined.');return e[t]=new r(n),e[t]},this.get=function(t){if(void 0===e[t])throw new Error('No model with the name "'+t+'" could be found.');return e[t]}};e.exports=i},function(e,t,n){var r=n(18),i=n(1),o=n(19),s=n(13),a=function(e){return this._build(e)};a.prototype={_fn:null,_name:null,_route:null,_view:null,_build:function(e){if(!e.name)throw new Error('Page "'+e.name+'" must have a name.');if(this._name=e.name,!e.fn)throw new Error('Page "'+e.name+'" must have a function.');if("function"!=typeof e.fn)throw new Error('"fn" declared in page "'+e.name+'" is not a function.');if(this._fn=e.fn,!e.route)throw new Error('Page "'+e.name+'" must have a route.');return"string"==typeof e.route&&(e.route={path:e.route,method:"GET"}),e.route.scheme=e.name,e.route.name=e.route.name?e.route.name:e.name,this._route=new r(e.route),i.register(this._route),e.view&&(this._view=s.add(this._name+"_view",e.view)),this},getViewContext:function(){if(!this._view)throw new Error(this._name+" page has no inner view. getViewContext() can not be called.");return this._view._context},renderView:function(e){if(!this._view)throw new Error(this._name+" page has no inner view. renderView() can not be called.");s.render(this._name+"_view",e)},run:function(e,t){if(!1!==t){var n=this;o.addEntry(e.getUrl(),function(){n._fn.call(n,e)})}this._fn.call(this,e)}},e.exports=a},function(e,t){var n=function(e){return this._params={},this._build(e)};n.prototype={_path:null,_pattern:null,_params:null,_method:null,_name:null,_scheme:null,_build:function(e){if(this._setMethod(e.method||"GET"),e.params&&this._setParams(e.params),!e.path)throw new Error("Path must be defined.");if(this._setPath(e.path),!e.name)throw new Error("Name must be defined.");return this._name=e.name,e.scheme&&(this._scheme=e.scheme),this},_setMethod:function(e){if("GET"!==(e=e.toUpperCase())&&"POST"!==e&&"GET|POST"!==e&&"POST|GET"!==e)throw new Error('Method is not supported. "GET", "POST", "GET|POST" only.');return this._method=new RegExp(e),this},_setParams:function(e){if(!1==e instanceof Object)throw new Error("Params must be an object.");for(var t in e)"number"===e[t]?e[t]="[0-9]+":"word"===e[t]?e[t]="[a-zA-Z0-9%]+":"slug"===e[t]&&(e[t]="[a-zA-Z0-9_-]+");return this._params=e,this},_setPath:function(e){return this._path=e,this._setPattern(e),this},_setPattern:function(e){this._pattern=e;var t;for(var n in this._params){if(t="{"+n+"}",-1===this._pattern.indexOf(t))throw new Error('Parameter "'+n+'" is not in route path "'+e+'".');this._pattern=this._pattern.replace(t,this._params[n])}return-1===this._pattern.indexOf(window.location.host)&&(this._pattern=window.location.host+this._pattern),this._pattern+="$",this._pattern=new RegExp(this._pattern),this},match:function(e,t){return e=e.split("?")[0],this._pattern.test(e)&&this._method.test(t)},extractParamsFromUrl:function(e){var t,n,r,i={};for(var o in this._params){t=this._path;for(n in this._params)t=t.replace("{"+n+"}",o===n?"("+this._params[n]+")":this._params[n]);(r=new RegExp(t).exec(e))&&(i[o]=decodeURI(r[1]))}return i},generateUrlWithParams:function(e,t){var n,r=this._path,i=[];for(var o in e)if(n="{"+o+"}",-1!==r.indexOf(n)){if(!new RegExp(this._params[o]).test(e[o]))throw new Error('Invalid parameter "'+o+'" for route path "'+this._path+'". Must match "'+this._params[o]+'".');r=r.replace(n,e[o])}else i.push(encodeURI(o)+"="+encodeURI(e[o]));return i.length>0&&(r+=(-1===r.indexOf("?")?"?":"&")+i.join("&")),!0===t&&(r=window.location.protocol+"//"+window.location.host+r),r},getName:function(){return this._name},getScheme:function(){return this._scheme}},e.exports=n},function(e,t,n){var r=n(12),i=n(4),o=function(){this._callbacks=[];var e=this;r.on("load",window,function(){setTimeout(function(){r.on("popstate",window,function(){return e._index=window.history.state?window.history.state.index:-1,(-1!==e._index||!e._loadEntry(e._index))&&(void 0===i(window.location.href,!1)&&void window.location.replace(window.location.href))})},1)})};o.prototype={_index:-1,_callbacks:null,_updateUrl:function(e){window.history.pushState({index:this.index},"",e)},_loadEntry:function(e){return!!this._callbacks[e]&&(this._callbacks[e](),!0)},addEntry:function(e,t){window.history.pushState&&(this._index++,this._callbacks.length-1>this._index&&this._callbacks.splice(this._index,this._callbacks.length-this._index),this._callbacks[this._index]=t,this._updateUrl(e))}},e.exports=new o},function(e,t,n){var r=n(9),i=n(0),o=n(21),s=n(3),a=n(1),l=function(e){return this._buildConfig(e),this};l.prototype={_root:null,_template:null,_templateUrl:null,_context:null,_onMounted:null,_onRender:null,_onRendered:null,_onUpdate:null,_onUpdated:null,_onRevoke:null,_onRevoked:null,_fusioner:null,_rendered:!1,_buildConfig:function(e){for(var t in e)null===this["_"+t]?this["_"+t]="context"===t?this._buildContext(e[t]):e[t]:this[t]=e[t];if(!this._root)throw new Error("Root must be defined to construct a view.");this._context||(this._context=this._buildContext({}))},_buildContext:function(e){var t,n={};for(t in e)!1==e[t]instanceof s&&(n[t]=e[t],delete e[t]);n=new s(n);for(t in e)n[t]=e[t];return n.generateUrl=function(e,t,n){return a.generateUrl(e,t,n)},n},_getRoot:function(){if("string"==typeof this._root){var e=i.first(this._root);if(!e)throw new Error('Root element with selector "'+this._root+'" could not been found.');this._root=e}return this._root},render:function(){var e=this;if(!this._template&&this._templateUrl?r.get(this._templateUrl,{t_ref:(new Date).getTime()},{async:!1,success:function(t){e._template=t},error:function(){throw new Error('Template located in "'+e._templateUrl+'" could not be loaded.')}}):this._template||this._templateUrl||(this._template=[this._getRoot()]),"string"==typeof this._template){this._template=i.createElement(this._template);var t=[];if(this._template instanceof HTMLElement)t.push(this._template);else if(this._template instanceof DocumentFragment)for(;this._template.firstChild;)t.push(this._template.removeChild(this._template.firstChild));this._template=t}if(!this._fusioner){var n={element:this._template,context:this._context,shouldApply:function(){return e._rendered}};"function"==typeof e._onUpdate&&(n.onUpdate=function(){e._onUpdate()}),"function"==typeof e._onUpdated&&(n.onUpdated=function(){e._onUpdated()}),this._fusioner=new o(n)}if(!this._rendered){"function"==typeof this._onRender&&this._onRender();var s=this._getRoot();this._template[0]!==s?i.insertElements(this._template,s):i.putBackElement(s),this._rendered=!0,"function"==typeof this._onRendered&&this._onRendered(),this._fusioner.applyChanges()}},revoke:function(){if(this._rendered){"function"==typeof this._onRevoke&&this._onRevoke();var e=this._getRoot();if(this._template[0]!==e)for(var t=0,n=this._template.length;t<n;++t)i.removeElement(this._template[t]);else i.putAsideElement(e);this._rendered=!1,"function"==typeof this._onRevoked&&this._onRevoked()}},getContext:function(){return this._context}},e.exports=l},function(e,t,n){var r=n(2),i=n(0),o=n(7),s=n(22),a=n(3),l=n(10),u=function(e){this._init=[],this._waiting=[],this._events={},!1==e.element instanceof Array&&(e.element=[e.element]),this._element=e.element,this._context=e.context,this._shouldApply=e.shouldApply,this._onUpdate=e.onUpdate,this._onUpdated=e.onUpdated;for(var t=0,n=this._element.length;t<n;++t)this._bind(this._element[t]);return this};u.prototype={_element:null,_context:null,_shouldApply:null,_init:null,_waiting:null,_events:null,_extractMarkers:function(e){if(e){var t=/\{\{((?!\{\{|\}\}).)*\}\}/g,n=/\{\{|\}\}/g,r=e.match(t);if(r&&r.length>0)return r=r.map(function(e){return{outer:e,inner:e.replace(n,"").trim()}}),r.length>0?r:[]}return[]},_extractContextProperties:function(e){for(var t,n,r=[],i=e.split(/[ |(|)|{|}|[|]|,|:|\+|"|']/g),o=0,s=i.length;o<s;++o)t=i[o].split("."),n=t.shift(),void 0!==this._context[n]&&(!1==this._context[n]instanceof a&&(t.unshift(n),n=null),r.push({model:n,path:t.join(".").replace(".length","")}));return r},_replaceAliases:function(e,t){if(t)for(var n in t)if(n===e)e=t[n];else{var r="([(|)|,|+|-|*|/])?(\\b"+n+"\\b)+([(|)|,|+|-|*|/])?";e=e.replace(new RegExp(r,"g"),function(e,r,i,o){return(r||"")+t[n]+(o||"")})}return e},_replaceAliasesInElement:function(e,t){var n,r;if(1===e.nodeType){if(e.getAttribute("data-no-bind"))return;if(e.attributes)for(n=0,r=e.attributes.length;n<r;++n)e.setAttribute(e.attributes[n].name,this._replaceAliases(e.attributes[n].value,t))}else if(3===e.nodeType){var i=e.textContent?"textContent":"nodeValue";e[i]=this._replaceAliases(e[i],t)}if(e.childNodes&&e.childNodes.length>0)for(n=0,r=e.childNodes.length;n<r;++n)this._replaceAliasesInElement(e.childNodes[n],t);return e},_evaluateText:function(e){var t=s.process(e,this._context);return t||0===t?t:""},_getPropPath:function(e){return(e.model?e.model+".":"")+e.path},_on:function(e,t,n){var i=this._getPropPath(t),o=i+":"+e;if(!this._events[o]){this._events[o]=[];var s=t.model?this._context[t.model]:this._context,a=this;s.on(e,t.path,function(n){a._dispatch(e,t,n)}),r.getPropertyValue(this._context,i)instanceof l&&(s.on("add",t.path,function(n){a._dispatch(e,t,n)}),s.on("remove",t.path,function(n){a._dispatch(e,t,n)}))}this._events[o].push(n)},_trigger:function(e,t,n){(t.model?this._context[t.model]:this._context).trigger(e,t.path,n)},_dispatch:function(e,t,n){var r=this._getPropPath(t)+":"+e;if(this._events[r].length>0){var i,o;if(!1!==this._shouldApply()){for("function"==typeof this._onUpdate&&this._onUpdate(),i=0,o=this._events[r].length;i<o;++i)this._events[r][i](n);"function"==typeof this._onUpdated&&this._onUpdated()}else for(i=0,o=this._events[r].length;i<o;++i)this._waiting.push(this._events[r][i])}},_bind:function(e,t){if(e){var n,a,u,c,h,f,p,d,_,m=this;if(1===e.nodeType){if(e.getAttribute("data-no-bind"))return;if(n=e.getAttribute("data-for")){t=t||{};var g=n.replace(/in .*/,"").trim(),v=null;-1!==g.indexOf(",")&&(g=g.split(","),v=g[0].trim(),g=g[1].trim());var w=n.replace(/.* in/,"").trim(),y=this._extractContextProperties(w,t),b=e.parentNode,x=i.getPosition(e);i.removeElement(e),e.removeAttribute("data-for");var E=s.process(w,this._context);if(void 0===E)throw new Error(w+" is an invalid expression for a loop.");var P=[];if(E instanceof l){a=y[0],u=this._getPropPath(a);var T=[],k=function(n){n=n||r.getPropertyValue(m._context,u);var o,s,a,l,c,h,f=[],p=[],d=[],_=[];for(o=0,a=n.length;o<a;++o)T[o]!==n[o]&&(T[o]?d.push(o):(c=e.cloneNode(!0),f.push(c),p.push(o),P.push(c)));if(T.length>n.length)for(o=T.length-1,a=n.length-1;o>a;--o)i.removeElement(P[o]),P.splice(o,1),_.push(o);else for(i.insertElements(f,b,x+(P.length-f.length)),o=0,a=p.length;o<a;++o)t[g]=u+"."+p[o],v&&(t[v]=p[o]+""),m._bind(m._replaceAliasesInElement(P[p[o]],t),t);if(d.length||_.length){var w=d.length?new RegExp("^"+u+"\\.(?:"+d.join("|")+")\\."):null,y=_.length?new RegExp("^"+u+"\\.(?:"+_.join("|")+")\\."):null;for(h in m._events)if(y&&y.test(h)&&(m._events[h]=[]),w&&w.test(h))for(s=0,l=m._events[h].length;s<l;++s)m._events[h][s]()}T=n.slice(0)};this._on("change",a,function(){k()}),k(E)}else if(E instanceof Object){var N=[];for(var O in E)E.hasOwnProperty(O)&&"function"!=typeof E[O]&&(N.push(O),P.push(e.cloneNode(!0)));for(i.insertElements(P,b,x),h=0,f=P.length;h<f;++h)v?(t[v]='"'+N[h]+'"',t[g]=w+"."+N[h]):t[g]='"'+N[h]+'"',m._bind(m._replaceAliasesInElement(P[h],t),t)}else if("number"==typeof E){var C=0,R=function(n){if((n=n||s.process(w,m._context))!==C){var r,o,a,l=[];if(n>C){for(r=C;r<n;++r)a=e.cloneNode(!0),l.push(a),P.push(a);for(i.insertElements(l,b,x),r=0,o=l.length;r<o;++r)t[g]=C+r+"",m._bind(m._replaceAliasesInElement(l[r],t),t)}else for(r=C;r>=n;--r)i.removeElement(P[r]),P.splice(r,1);C=n}};if(y.length>0)for(h=0,f=y.length;h<f;++h)this._on("change",y[h],function(){R()});R(E)}return}if(n=e.getAttribute("data-bind")){if(a=this._extractContextProperties(n),0===a.length)throw new Error('Data-bind with value "'+n+'" refers to a non existing context property.');a=a[0],u=this._getPropPath(a);var U,A=e.tagName.toLowerCase();"select"===A||"input"===A&&("radio"===e.type||"checkbox"===e.type)?(U=function(t){t=t||r.getPropertyValue(m._context,u),"radio"===e.type||"checkbox"===e.type?!0===t||t===e.value?e.checked="checked":e.checked="":e.value=t},m._init.push(function(){U(r.getPropertyValue(m._context,u))}),this._on("change",a,U),o.on("change",e,function(t){var n=t.target||t.srcElement,r=n.value;"radio"!==e.type&&"checkbox"!==e.type||(r="checkbox"===n.type&&"on"===r?!!n.checked:n.checked?r:null),m._trigger("change",a,r)})):"textarea"!==A&&"input"!==A||(U=function(t){t=t||r.getPropertyValue(m._context,u),e.value=t||""},U(r.getPropertyValue(this._context,u)),this._on("change",a,U),c="oninput"in e?"input":"keyup, keypress",o.on(c,e,function(e){var t=e.target||e.srcElement;m._trigger("change",a,t.value)}))}if(n=e.getAttribute("data-events")){var S,M,L=n.split(";");for(h=0,f=L.length;h<f;++h)S=L[h].split(":"),2===S.length&&(c=S[0].trim(),M=S[1].trim(),o.on(c,e,function(e){m._context.e=e,s.process(M,m._context)}));e.removeAttribute("data-events")}if((n=e.getAttribute("data-if"))&&(!function(t){var n=function(){var n=s.process(t,m._context);void 0===n||!1===n||null===n||""===n?i.putAsideElement(e):i.putBackElement(e)};e.parentNode?n():m._init.push(n),m._extractContextProperties(t).forEach(function(e){"function"!=typeof r.getPropertyValue(m._context,m._getPropPath(e))&&m._on("change",e,n)})}(n),e.removeAttribute("data-if")),(n=e.getAttribute("data-show"))&&(!function(t){var n=function(){var n=s.process(t,m._context);e.style.display=void 0===n||!1===n||null===n||""===n?"none":""};n(),m._extractContextProperties(t).forEach(function(e){"function"!=typeof r.getPropertyValue(m._context,m._getPropPath(e))&&m._on("change",e,n)})}(n),e.removeAttribute("data-show")),e.attributes)for(h=0,f=e.attributes.length;h<f;++h)p=e.attributes[h].name,(d=e.attributes[h].value)&&(_=m._extractMarkers(d),_.length>0&&function(t,n,i){var o=function(){for(var r=n,o=0,s=i.length;o<s;++o)r=r.replace(i[o].outer,m._evaluateText(i[o].inner));e.setAttribute(t,r)};o(),i.forEach(function(e){m._extractContextProperties(e.inner).forEach(function(e){"function"!=typeof r.getPropertyValue(m._context,m._getPropPath(e))&&m._on("change",e,o)})})}(p,d,_))}else if(3===e.nodeType){var V=e.textContent?"textContent":"nodeValue";if((d=e[V].trim())&&(_=this._extractMarkers(d),_.length>0)){var j=function(){for(var t=d,n=0,r=_.length;n<r;++n)t=t.replace(_[n].outer,m._evaluateText(_[n].inner));e[V]=t};for(j(),h=0,f=_.length;h<f;++h)this._extractContextProperties(_[h].inner).forEach(function(e){"function"!=typeof r.getPropertyValue(m._context,m._getPropPath(e))&&m._on("change",e,j)})}}if(e.childNodes&&e.childNodes.length>0)for(h=0,f=e.childNodes.length;h<f;++h)this._bind(e.childNodes[h],t);return e}},applyChanges:function(){var e,t;if(this._init.length>0){for(e=0,t=this._init.length;e<t;++e)this._init[e]();this._init=[]}if(this._waiting.length>0){for("function"==typeof this._onUpdate&&this._onUpdate(),e=0,t=this._waiting.length;e<t;++e)this._waiting[e]();this._waiting=[],"function"==typeof this._onUpdated&&this._onUpdated()}}},e.exports=u},function(e,t){var n=function(){"use strict";var e,t,n,r,i,o,s,a,l,u,c,h,f=",",p={"!":function(e,t){return!t[e+1]},"*":function(e,t){return t[e-1]*t[e+1]},"/":function(e,t){return t[e-1]/t[e+1]},"%":function(e,t){return t[e-1]%t[e+1]},"-":function(e,t){return(t[e-1]||0)-t[e+1]},"+":function(e,t){var n=void 0!==t[e-1]?t[e-1]:0;null===n&&(n="");var r=void 0!==t[e+1]?t[e+1]:0;return null===r&&(r=""),n+r},"!=":function(e,t){return t[e-1]!==t[e+1]},"==":function(e,t){return t[e-1]===t[e+1]},">":function(e,t){return t[e-1]>t[e+1]},">=":function(e,t){return t[e-1]>=t[e+1]},"<":function(e,t){return t[e-1]<t[e+1]},"<=":function(e,t){return t[e-1]<=t[e+1]},"&&":function(e,t){return t[e-1]&&t[e+1]},"||":function(e,t){return t[e-1]||t[e+1]},"?":function(e,t){var n=":"===t[e+1]?"":t[e+1],r=void 0===t[e+3]?":"===t[e+2]?"":t[e+2]:t[e+3];return t[e-1]?n:r}};this.process=function(d,_){function m(e){return!0!==e}function g(e){h.push(e)}function v(){return h.pop()}function w(e){return/^[a-z.]+\(/i.test(e)}function y(e){return void 0!==p[e]}function b(n){u&&(e++,t[e]="",u=!1),t[e]+=n}function x(e){E(),b(e)}function E(){""!==t[e]&&(u=!0),!0===c&&(t[e]=T(t[e]),c=!1)}function P(e,t){var n=e.split(".");if(_&&void 0!==_[n[0]]){var r,i=_,o=i,s=n.length;for(r=0;r<s;++r){if(void 0===i[n[r]])return;o=i,i=i[n[r]]}return"function"==typeof i&&(i=i.apply(o,t)),i}}function T(e){switch(e){case"undefined":return;case"null":return null;case"false":return!1;case"true":return!0;default:return isNaN(e)?P(e):parseFloat(e)}}function k(n,r){for(var i=n;i<r;++i)"{"===t[i]||":"===t[i]||"}"===t[i]||","===t[i]||"["===t[i]||"]"===t[i]||!isNaN(parseFloat(t[i]))&&isFinite(t[i])||(t[i]='"'+t[i]+'"');var o=t.splice(n,r-n+1),s=JSON.parse(o.join(""));t[n]=s,e=n}function N(n){n=n||t;var r,i,o,s,a;for(s in p)if(void 0!==l[s])for(;(a=n.indexOf(s))>-1;)"?"===s?(r=a-1,i=5):"!"===s?(r=a,i=2):(r=a-1>=0?a-1:a,i=e===r?2:3),o=p[s](a,n),n.splice(r,i,o)}e=0,t=[""],n=!1,r=!1,i=!1,o=!1,s=0,a=0,l={},u=!1,c=!1,h=[];var O,C,R=d.length;for(O=0;O<R;++O)switch(C=d[O]){case'"':if(!n&&!i){r=m(r),r&&!o||E();continue}c=!1,b(C);break;case"'":if(!r&&!i){n=m(n),n&&!o||E();continue}c=!1,b(C);break;case"\\":if(i=m(i))continue;b(C);break;default:if(function(){return n||r}())b(C);else switch(C){case" ":E();break;case f:case":":x(C),E();break;case"[":x(C),E(),0===a+s&&g(e),++a;break;case"]":x(C),E(),--a,0===a+s&&k(v(),e);break;case"{":x(C),E(),0===a+s&&g(e),++s;break;case"}":x(C),E(),--s,0===a+s&&k(v(),e);break;case"(":w(t[e]+C)?c=!1:E(),b(C),E(),g(e);break;case")":x(C),E();var U=v();w(t[U])?function(n,r){t.splice(r,1);var i=t[n].substring(0,t[n].length-1),o=t.splice(n+1,r);N(o);var s=o.filter(function(e){return e!==f});t[n]=P(i,s),e=n}(U,e):function(n,r){var i=t.splice(n+1,r-n-1);N(i),t.splice(n,2,i[0]),e=n}(U,e);break;default:y(t[e]+C)?(o=!0,c=!1,l[t[e]+C]=!0):y(C)?(o||E(),o=!0,c=!1,l[C]=!0):o?(E(),o=!1,c=!0,l[t[e]]=!0):c=!0,b(C)}}if(c&&(t[e]=T(t[e])),N(t),t.length>1)throw new Error('Invalid expression "'+d+'".');return t[0]}};e.exports=new n},function(e,t,n){var r=n(0),i=function(e){return this._components={},this._query={},this._post={},this._build(e)};i.prototype={_event:null,_protocol:null,_host:null,_port:null,_path:null,_url:null,_method:null,_hash:null,_components:null,_query:null,_post:null,_build:function(e){this._event=e.event;var t=document.createElement("a");return t.href=e.event.target.action||e.event.target.href,this._protocol=t.protocol.replace(":",""),this._host=t.hostname,this._port=parseInt(e.port),isNaN(this._port)&&(this._port=parseInt(window.location.port.replace(":")),isNaN(this._port)&&(this._port="https:"===window.location.protocol?443:80)),this._path=t.pathname.replace("//","/"),this._url=t.href,this._method=(e.event.target.method||"GET").toUpperCase(),this._hash=t.hash,e.route&&(this._components=e.route.extractParamsFromUrl(t.href)),t.search&&(this._query=JSON.parse('{"'+decodeURI(t.search.substring(1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')),"FORM"===e.event.target.tagName.toUpperCase()&&"POST"===this._method&&(this._post=r.formToObject(e.event.target)),this},getEvent:function(){return this._event},getProtocol:function(){return this._protocol},getHost:function(){return this._host},getPath:function(){return this._path},getUrl:function(){return this._url},getPort:function(){return this._port},getMethod:function(){return this._method},getHash:function(){return this._hash},getUriComponents:function(){return this._components},getQueryParams:function(){return this._query},getPostParams:function(){return this._post}},e.exports=i}]);